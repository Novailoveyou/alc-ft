generator client {
  provider = "prisma-client-js"
}

generator zod {
  provider = "zod-prisma"
  output   = "./zod" // (default) the directory where generated zod schemas will be saved
  imports  = "../zod-schemas"

  relationModel = true // (default) Create and export both plain and related models.
  // relationModel         = "default" // Do not export model without relations.
  // relationModel         = false // Do not generate related model

  modelCase = "PascalCase" // (default) Output models using pascal case (ex. UserModel, PostModel)
  // modelCase             = "camelCase" // Output models using camel case (ex. userModel, postModel)

  modelSuffix = "Model" // (default) Suffix to apply to your prisma models when naming Zod schemas

  // useDecimalJs          = false // (default) represent the prisma Decimal type using as a JS number
  useDecimalJs = true // represent the prisma Decimal type using Decimal.js (as Prisma does)

  // imports = null // (default) will import the referenced file in generated schemas to be used via imports.someExportedVariable

  // https://www.prisma.io/docs/concepts/components/prisma-client/working-with-fields/working-with-json-fields#filtering-by-null-values
  prismaJsonNullability = true // (default) uses prisma's scheme for JSON field nullability
  // prismaJsonNullability = false // allows null assignment to optional JSON fields
}

datasource db {
  provider = "postgresql"
  url      = env("POSTGRES_PRISMA_URL") // uses connection pooling
}

enum Locale {
  ru
  en
  kk
  be
}

enum PageName {
  home
  catalog
  manufacturer
  product
  cart
  articles
  article
  about
  usage
  docs
  contact
  lead
}

model Image {
  /// The unique identifier for the record
  /// @default {Generated by database}
  id String @id @default(cuid())

  /// locale of the record
  /// @default {ru}
  locale Locale @default(ru)

  /// whether record is published
  /// @default {false}
  isPublished Boolean @default(false)

  /// date of record creation
  /// @default {now()}
  createdAt DateTime @default(now()) @map(name: "created_at")

  /// date of record update
  /// @default {now()}
  updatedAt DateTime @default(now()) @updatedAt @map(name: "updated_at")

  /// link to the image
  /// @zod.string().trim().min(3).max(3000).refine(validator.isURL)
  src String

  /// alternative text for the image
  /// @zod.string().trim().min(2).max(5000).optional()
  alt String?

  /// slides with this image
  slides Slide[]

  /// categories with this image
  categories Category[]

  /// testimonials with this image
  testimonials Testimonial[]

  /// products with this image
  product Product[]

  @@map(name: "images")
}

model PhoneNumer {
  /// The unique identifier for the record
  /// @default {Generated by database}
  id String @id @default(cuid())

  /// locale of the record
  /// @default {ru}
  locale Locale @default(ru)

  /// whether record is published
  /// @default {false}
  isPublished Boolean @default(false)

  /// date of record creation
  /// @default {now()}
  createdAt DateTime @default(now()) @map(name: "created_at")

  /// date of record update
  /// @default {now()}
  updatedAt DateTime @default(now()) @updatedAt @map(name: "updated_at")

  /// phone value
  /// @zod.string().trim().min(1).max(120).refine(validator.isMobilePhone)
  value String

  /// phone label
  /// @zod.string().trim().min(1).max(120).optional()
  label String?

  /// buttons with this phone number
  buttons Button[]

  @@unique([value])
  @@map(name: "contactPhoneNumbers")
}

model Email {
  /// The unique identifier for the record
  /// @default {Generated by database}
  id String @id @default(cuid())

  /// locale of the record
  /// @default {ru}
  locale Locale @default(ru)

  /// whether record is published
  /// @default {false}
  isPublished Boolean @default(false)

  /// date of record creation
  /// @default {now()}
  createdAt DateTime @default(now()) @map(name: "created_at")

  /// date of record update
  /// @default {now()}
  updatedAt DateTime @default(now()) @updatedAt @map(name: "updated_at")

  /// email value
  /// @zod.string().trim().min(1).max(320).refine(validator.isEmail)
  value String

  /// email label
  /// @zod.string().trim().min(1).max(320).optional()
  label String?

  /// buttons with this email
  buttons Button[]

  @@unique([value])
  @@map(name: "contactEmails")
}

model Button {
  /// The unique identifier for the record
  /// @default {Generated by database}
  id String @id @default(cuid())

  /// locale of the record
  /// @default {ru}
  locale Locale @default(ru)

  /// whether record is published
  /// @default {false}
  isPublished Boolean @default(false)

  /// date of record creation
  /// @default {now()}
  createdAt DateTime @default(now()) @map(name: "created_at")

  /// date of record update
  /// @default {now()}
  updatedAt DateTime @default(now()) @updatedAt @map(name: "updated_at")

  /// button text
  /// @zod.string().trim().min(1).max(80)
  text String

  /// if button is intended to be a trigger to phone call, then phoneNumberTo is the number to call
  phoneNumberTo   PhoneNumer? @relation(fields: [phoneNumberToId], references: [id])
  phoneNumberToId String?

  /// if button is intended to be a trigger to email, then emailTo is the email to send to
  emailTo   Email?  @relation(fields: [emailToId], references: [id])
  emailToId String?

  /// if button is intended to be a link, then linkTo is the link
  linkTo PageName?

  /// if button is intended to be a language change, then localeTo is the language
  localeTo Locale?

  /// categories with this button
  categories Category[]

  /// slides with this button
  slides Slide[]

  /// forms with this button
  forms Form[]

  /// headers with this button
  headers Header[]

  /// footers with this button
  footers Footer[]

  /// products with this button
  products Product[]

  @@map(name: "buttons")
}

model Slide {
  /// The unique identifier for the record
  /// @default {Generated by database}
  id String @id @default(cuid())

  /// locale of the record
  /// @default {ru}
  locale Locale @default(ru)

  /// whether record is published
  /// @default {false}
  isPublished Boolean @default(false)

  /// date of record creation
  /// @default {now()}
  createdAt DateTime @default(now()) @map(name: "created_at")

  /// date of record update
  /// @default {now()}
  updatedAt DateTime @default(now()) @updatedAt @map(name: "updated_at")

  /// an element with border above the title
  /// @zod.string().trim().min(1).max(80)
  strap String

  /// slide title
  /// @zod.string().trim().min(3).max(3000)
  title String

  /// slide subtitle
  /// @zod.string().trim().min(3).max(3000).optional()
  subtitle String?

  /// Whether the slide has cornered rectangle positioned just right of the image
  isDecoration Boolean @default(true)

  /// Slide image
  image   Image  @relation(fields: [imageId], references: [id])
  imageId String

  /// SectionGallery with this slide
  sectionGallery   SectionGallery? @relation(fields: [sectionGalleryId], references: [id])
  sectionGalleryId String?

  /// Slide button
  buttons Button[]

  @@map(name: "slides")
}

model Form {
  /// The unique identifier for the record
  /// @default {Generated by database}
  id String @id @default(cuid())

  /// locale of the record
  /// @default {ru}
  locale Locale @default(ru)

  /// whether record is published
  /// @default {false}
  isPublished Boolean @default(false)

  /// date of record creation
  /// @default {now()}
  createdAt DateTime @default(now()) @map(name: "created_at")

  /// date of record update
  /// @default {now()}
  updatedAt DateTime @default(now()) @updatedAt @map(name: "updated_at")

  /// form title
  /// @zod.string().trim().min(3).max(60)
  title String

  /// form description
  /// @zod.string().trim().min(3).max(120)
  description String

  /// is user name input field displayed on the form
  isName Boolean? @default(false)

  /// is user phone number input field displayed on the form
  isPhoneNumber Boolean? @default(true)

  /// is email input field displayed on the form
  isEmail Boolean? @default(false)

  /// is user agreement input field displayed on the form
  isAgreement Boolean @default(true)

  /// form button
  button   Button @relation(fields: [buttonId], references: [id])
  buttonId String

  /// footers with this form
  footers Footer[]

  /// products with this form
  product Product[]

  @@map(name: "forms")
}

model Testimonial {
  /// The unique identifier for the record
  /// @default {Generated by database}
  id String @id @default(cuid())

  /// locale of the record
  /// @default {ru}
  locale Locale @default(ru)

  /// whether record is published
  /// @default {false}
  isPublished Boolean @default(false)

  /// date of record creation
  /// @default {now()}
  createdAt DateTime @default(now()) @map(name: "created_at")

  /// date of record update
  /// @default {now()}
  updatedAt DateTime @default(now()) @updatedAt @map(name: "updated_at")

  /// testimonial title
  /// @zod.string().trim().min(1).max(60)
  title String

  /// testimonial description
  /// @zod.string().trim().min(1).max(300)
  description String

  /// testimonial image
  image   Image  @relation(fields: [imageId], references: [id])
  imageId String

  sectionTestimonials SectionTestimonials[]

  @@map(name: "testimonials")
}

model Page {
  /// The unique identifier for the record
  /// @default {Generated by database}
  id String @id @default(cuid())

  /// locale of the record
  /// @default {ru}
  locale Locale @default(ru)

  /// whether record is published
  /// @default {false}
  isPublished Boolean @default(false)

  /// date of record creation
  /// @default {now()}
  createdAt DateTime @default(now()) @map(name: "created_at")

  /// date of record update
  /// @default {now()}
  updatedAt DateTime @default(now()) @updatedAt @map(name: "updated_at")

  /// page name
  name PageName @default(home)

  /// page header
  header   Header? @relation(fields: [headerId], references: [id])
  headerId String?

  /// page gallery section
  sectionGallery   SectionGallery? @relation(fields: [sectionGalleryId], references: [id])
  sectionGalleryId String?

  /// page catalog section
  sectionCatalog   SectionCatalog? @relation(fields: [sectionCatalogId], references: [id])
  sectionCatalogId String?

  /// page footer
  footer   Footer? @relation(fields: [footerId], references: [id])
  footerId String?

  /// page testimonials section
  sectionTestimonials   SectionTestimonials? @relation(fields: [sectionTestimonialsId], references: [id])
  sectionTestimonialsId String?

  @@unique([name])
  @@map(name: "pages")
}

model ParameterValue {
  /// The unique identifier for the record
  /// @default {Generated by database}
  id String @id @default(cuid())

  /// locale of the record
  /// @default {ru}
  locale Locale @default(ru)

  /// whether record is published
  /// @default {false}
  isPublished Boolean @default(false)

  /// date of record creation
  /// @default {now()}
  createdAt DateTime @default(now()) @map(name: "created_at")

  /// date of record update
  /// @default {now()}
  updatedAt DateTime @default(now()) @updatedAt @map(name: "updated_at")

  /// ParameterValue value
  /// @zod.string().trim().min(1).max(240)
  value String

  /// ParameterValue parameter
  parameter   Parameter @relation(fields: [parameterId], references: [id])
  parameterId String

  @@map(name: "parameterValues")
}

model Parameter {
  /// The unique identifier for the record
  /// @default {Generated by database}
  id String @id @default(cuid())

  /// locale of the record
  /// @default {ru}
  locale Locale @default(ru)

  /// whether record is published
  /// @default {false}
  isPublished Boolean @default(false)

  /// date of record creation
  /// @default {now()}
  createdAt DateTime @default(now()) @map(name: "created_at")

  /// date of record update
  /// @default {now()}
  updatedAt DateTime @default(now()) @updatedAt @map(name: "updated_at")

  /// parameter title
  /// @zod.string().trim().min(1).max(240)
  title String

  /// whether parameter is highlighted
  isHighlighted Boolean @default(false)

  /// parameter values
  values ParameterValue[]

  /// parameter product
  products Product[]

  @@map(name: "parameters")
}

model ProductTestimonial {
  /// The unique identifier for the record
  /// @default {Generated by database}
  id String @id @default(cuid())

  /// locale of the record
  /// @default {ru}
  locale Locale @default(ru)

  /// whether record is published
  /// @default {false}
  isPublished Boolean @default(false)

  /// date of record creation
  /// @default {now()}
  createdAt DateTime @default(now()) @map(name: "created_at")

  /// date of record update
  /// @default {now()}
  updatedAt DateTime @default(now()) @updatedAt @map(name: "updated_at")

  /// ProductTestimonial title
  /// @zod.string().trim().min(3).max(80)
  title String

  /// ProductTestimonial product
  product Product[]

  @@map(name: "productTestimonials")
}

model Category {
  /// The unique identifier for the record
  /// @default {Generated by database}
  id String @id @default(cuid())

  /// locale of the record
  /// @default {ru}
  locale Locale @default(ru)

  /// whether record is published
  /// @default {false}
  isPublished Boolean @default(false)

  /// date of record creation
  /// @default {now()}
  createdAt DateTime @default(now()) @map(name: "created_at")

  /// date of record update
  /// @default {now()}
  updatedAt DateTime @default(now()) @updatedAt @map(name: "updated_at")

  /// category slug
  /// @zod.string().trim().refine(validator.isSlug)
  slug String @default(uuid())

  /// category name
  /// @zod.string().trim().min(2).max(100)
  name String

  /// category short description
  /// @zod.string().trim().min(3).max(300)
  description String

  /// category long description
  /// @zod.string().trim().min(3).max(1200)
  longDescription String?

  /// button with this card
  button   Button @relation(fields: [buttonId], references: [id])
  buttonId String

  /// Image with this card
  image   Image  @relation(fields: [imageId], references: [id])
  imageId String

  /// SectionCatalog with this card
  sectionCatalog   SectionCatalog? @relation(fields: [sectionCatalogId], references: [id])
  sectionCatalogId String?

  /// category products
  product Product[]

  @@unique([slug])
  @@map(name: "categories")
}

model Product {
  /// The unique identifier for the record
  /// @default {Generated by database}
  id String @id @default(cuid())

  /// locale of the record
  /// @default {ru}
  locale Locale @default(ru)

  /// whether record is published
  /// @default {false}
  isPublished Boolean @default(false)

  /// date of record creation
  /// @default {now()}
  createdAt DateTime @default(now()) @map(name: "created_at")

  /// date of record update
  /// @default {now()}
  updatedAt DateTime @default(now()) @updatedAt @map(name: "updated_at")

  /// product slug
  /// @zod.string().trim().refine(validator.isSlug)
  slug String @default(uuid())

  /// product name
  /// @zod.string().trim().min(2).max(100)
  name String

  /// short descriptoon
  /// @zod.string().trim().min(3).max(120)
  description String

  /// product description
  /// @zod.string().trim().min(3).max(1200).optional()
  longDescription String?

  /// product category
  category     Category @relation(fields: [categorySlug], references: [slug])
  categorySlug String

  /// product form
  form   Form   @relation(fields: [formId], references: [id])
  formId String

  /// product image
  image   Image  @relation(fields: [imageId], references: [id])
  imageId String

  /// product parameters
  parameters Parameter[]

  /// product testimonials
  productTestimonials ProductTestimonial[]

  /// product buttons
  buttons Button[]

  @@unique([categorySlug, slug], name: "unique_category_product_slug")
  @@map(name: "products")
}

model Header {
  /// The unique identifier for the record
  /// @default {Generated by database}
  id String @id @default(cuid())

  /// locale of the record
  /// @default {ru}
  locale Locale @default(ru)

  /// whether record is published
  /// @default {false}
  isPublished Boolean @default(false)

  /// date of record creation
  /// @default {now()}
  createdAt DateTime @default(now()) @map(name: "created_at")

  /// date of record update
  /// @default {now()}
  updatedAt DateTime @default(now()) @updatedAt @map(name: "updated_at")

  /// header buttons
  buttons Button[]

  /// pages with this header
  pages Page[]

  @@map(name: "headers")
}

model SectionGallery {
  /// The unique identifier for the record
  /// @default {Generated by database}
  id String @id @default(cuid())

  /// locale of the record
  /// @default {ru}
  locale Locale @default(ru)

  /// whether record is published
  /// @default {false}
  isPublished Boolean @default(false)

  /// date of record creation
  /// @default {now()}
  createdAt DateTime @default(now()) @map(name: "created_at")

  /// date of record update
  /// @default {now()}
  updatedAt DateTime @default(now()) @updatedAt @map(name: "updated_at")

  /// gallery slides 
  slides Slide[]

  /// pages with this section
  pages Page[]

  @@map(name: "sectionGalleries")
}

model SectionCatalog {
  /// The unique identifier for the record
  /// @default {Generated by database}
  id String @id @default(cuid())

  /// locale of the record
  /// @default {ru}
  locale Locale @default(ru)

  /// whether record is published
  /// @default {false}
  isPublished Boolean @default(false)

  /// date of record creation
  /// @default {now()}
  createdAt DateTime @default(now()) @map(name: "created_at")

  /// date of record update
  /// @default {now()}
  updatedAt DateTime @default(now()) @updatedAt @map(name: "updated_at")

  /// section title
  /// @zod.string().trim().min(1).max(60)
  title String

  /// sections categories
  categories Category[]

  /// pages with this section
  pages Page[]

  @@map(name: "sectionCatalogs")
}

model SectionTestimonials {
  /// The unique identifier for the record
  /// @default {Generated by database}
  id String @id @default(cuid())

  /// locale of the record
  /// @default {ru}
  locale Locale @default(ru)

  /// whether record is published
  /// @default {false}
  isPublished Boolean @default(false)

  /// date of record creation
  /// @default {now()}
  createdAt DateTime @default(now()) @map(name: "created_at")

  /// date of record update
  /// @default {now()}
  updatedAt DateTime @default(now()) @updatedAt @map(name: "updated_at")

  /// section title
  /// @zod.string().trim().min(1).max(60)
  title String

  /// section testimonials
  testimonials Testimonial[]

  /// pages with this section
  pages Page[]

  @@map(name: "sectionTestimonials")
}

model Footer {
  /// The unique identifier for the record
  /// @default {Generated by database}
  id String @id @default(cuid())

  /// locale of the record
  /// @default {ru}
  locale Locale @default(ru)

  /// whether record is published
  /// @default {false}
  isPublished Boolean @default(false)

  /// date of record creation
  /// @default {now()}
  createdAt DateTime @default(now()) @map(name: "created_at")

  /// date of record update
  /// @default {now()}
  updatedAt DateTime @default(now()) @updatedAt @map(name: "updated_at")

  /// footer form
  form   Form?   @relation(fields: [formId], references: [id])
  formId String?

  /// footer buttons
  buttons Button[]

  /// pages with this footer
  pages Page[]

  @@map(name: "footers")
}

model Lead {
  /// The unique identifier for the lead
  /// @default {Generated by database}
  id String @id @default(cuid())

  /// User who submitted the lead
  user   User   @relation(fields: [userId], references: [id])
  userId String

  /// user url from which the request came
  /// @zod.string().trim().min(1).max(10000)
  url String

  /// form name on the page from which the lead came
  /// @zod.string().trim().min(1).max(100)
  formName String

  /// user ip
  /// @zod.string().trim().min(1).max(39)
  ip String

  /// Google analitics client ID
  /// @zod.string().trim().min(1).max(100).optional()
  gmClientId String?

  /// Yandex metrics ID
  /// @zod.string().trim().min(1).max(100).optional()
  ymClientID String?

  /// user agent
  /// @zod.string().trim().min(1).max(100)
  userAgent String

  /// user utm_source url param
  /// @zod.string().trim().min(1).max(400).optional()
  utm_source String?

  /// user utm_medium url param
  /// @zod.string().trim().min(1).max(400).optional()
  utm_medium String?

  /// user utm_campaign url param
  /// @zod.string().trim().min(1).max(400).optional()
  utm_campaign String?

  /// user utm_content url param
  /// @zod.string().trim().min(1).max(400).optional()
  utm_content String?

  /// user utm_term url param
  /// @zod.string().trim().min(1).max(400).optional()
  utm_term String?

  /// createdAt user date at the request time
  /// @zod.custom(z.coerce.date())
  createdAt DateTime @default(now()) @map(name: "created_at")

  /// lead locale
  locale Locale @default(ru)

  @@map(name: "leads")
}

model User {
  /// The unique identifier for the user
  /// @default {Generated by database}
  id String @id @default(cuid())

  /// user name
  /// @zod.string().trim().min(2).max(100).optional()
  name String?

  /// user personal data usage agreement
  /// @zod.custom(z.literal(true))
  isDataUsageAgreement Boolean @default(false)

  /// user company
  /// @zod.string().trim().min(5).max(200).optional()
  company String?

  /// createdAt user date at the request time
  /// @zod.custom(z.coerce.date())
  createdAt DateTime @default(now()) @map(name: "created_at")

  /// updatedAt user date at the request time 
  /// @zod.custom(z.coerce.date())
  updatedAt DateTime @updatedAt @map(name: "updated_at")

  /// user locale
  locale Locale @default(ru)

  leads Lead[]

  @@map(name: "users")
}
